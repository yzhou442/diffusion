03/19/2025 22:24:11 - INFO - __main__ - ***** Training arguments *****
03/19/2025 22:24:11 - INFO - __main__ - Namespace(config='configs/ddim.yaml', data_dir='../imagenet100_128x128/train', image_size=128, batch_size=32, num_workers=5, num_classes=100, run_name='exp-14-ddpm', output_dir='experiments', num_epochs=2, learning_rate=0.0001, weight_decay=1e-05, grad_clip=1.0, seed=42, mixed_precision='fp16', num_train_timesteps=1000, num_inference_steps=20, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, unet_in_size=128, unet_in_ch=3, unet_ch=64, unet_ch_mult=[1, 2, 2, 4], unet_attn=[2, 3], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, use_cfg=False, cfg_guidance_scale=2.0, use_ddim=True, ckpt=None, distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=32, max_train_steps=8124)
03/19/2025 22:24:11 - INFO - __main__ - ***** Running training *****
03/19/2025 22:24:11 - INFO - __main__ -   Num examples = 130000
03/19/2025 22:24:11 - INFO - __main__ -   Num Epochs = 2
03/19/2025 22:24:11 - INFO - __main__ -   Instantaneous batch size per device = 32
03/19/2025 22:24:11 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/19/2025 22:24:11 - INFO - __main__ -   Total optimization steps per epoch 4062
03/19/2025 22:24:11 - INFO - __main__ -   Total optimization steps = 8124
  0%|                                                     | 0/8124 [00:00<?, ?it/s]03/19/2025 22:24:11 - INFO - __main__ - Epoch 1/2
  0%|                                           | 1/8124 [00:00<2:15:21,  1.00it/s]03/19/2025 22:24:12 - INFO - __main__ - Epoch 1/2, Step 0/4062, Loss 0.9970707297325134 (0.9970707297325134)
  1%|▌                                        | 101/8124 [00:46<1:00:58,  2.19it/s]03/19/2025 22:24:58 - INFO - __main__ - Epoch 1/2, Step 100/4062, Loss 0.6311421394348145 (0.8336752706234998)
  2%|█                                        | 201/8124 [01:32<1:00:14,  2.19it/s]03/19/2025 22:25:44 - INFO - __main__ - Epoch 1/2, Step 200/4062, Loss 0.2895941436290741 (0.6408829651958313)
  4%|█▌                                         | 301/8124 [02:17<59:27,  2.19it/s]03/19/2025 22:26:29 - INFO - __main__ - Epoch 1/2, Step 300/4062, Loss 0.12075944989919662 (0.49063329670912403)
  5%|██                                         | 401/8124 [03:03<58:43,  2.19it/s]03/19/2025 22:27:15 - INFO - __main__ - Epoch 1/2, Step 400/4062, Loss 0.03953031077980995 (0.3852981547000551)
  6%|██▋                                        | 501/8124 [03:48<57:57,  2.19it/s]03/19/2025 22:28:00 - INFO - __main__ - Epoch 1/2, Step 500/4062, Loss 0.02613256871700287 (0.31664732467018797)
  7%|███▏                                       | 601/8124 [04:34<57:10,  2.19it/s]03/19/2025 22:28:46 - INFO - __main__ - Epoch 1/2, Step 600/4062, Loss 0.021044712513685226 (0.2694252491502491)
  9%|███▋                                       | 701/8124 [05:20<56:26,  2.19it/s]03/19/2025 22:29:32 - INFO - __main__ - Epoch 1/2, Step 700/4062, Loss 0.045747093856334686 (0.23552180102464348)
 10%|████▏                                      | 801/8124 [06:05<55:40,  2.19it/s]03/19/2025 22:30:17 - INFO - __main__ - Epoch 1/2, Step 800/4062, Loss 0.02337946556508541 (0.2095956111863981)
 11%|████▊                                      | 901/8124 [06:51<54:57,  2.19it/s]03/19/2025 22:31:03 - INFO - __main__ - Epoch 1/2, Step 900/4062, Loss 0.018544405698776245 (0.1895249977079401)
 12%|█████▏                                    | 1001/8124 [07:37<54:10,  2.19it/s]03/19/2025 22:31:49 - INFO - __main__ - Epoch 1/2, Step 1000/4062, Loss 0.02502191811800003 (0.17339008682306026)
 14%|█████▋                                    | 1101/8124 [08:22<53:23,  2.19it/s]03/19/2025 22:32:34 - INFO - __main__ - Epoch 1/2, Step 1100/4062, Loss 0.024561775848269463 (0.16008006421921878)
 15%|██████▏                                   | 1201/8124 [09:08<52:38,  2.19it/s]03/19/2025 22:33:20 - INFO - __main__ - Epoch 1/2, Step 1200/4062, Loss 0.019121598452329636 (0.1489976443122331)
 16%|██████▋                                   | 1301/8124 [09:53<51:51,  2.19it/s]03/19/2025 22:34:05 - INFO - __main__ - Epoch 1/2, Step 1300/4062, Loss 0.03843109309673309 (0.13944799747306577)
 17%|███████▏                                  | 1401/8124 [10:39<51:07,  2.19it/s]03/19/2025 22:34:51 - INFO - __main__ - Epoch 1/2, Step 1400/4062, Loss 0.03194589167833328 (0.13137202486222999)
 18%|███████▊                                  | 1501/8124 [11:25<50:20,  2.19it/s]03/19/2025 22:35:37 - INFO - __main__ - Epoch 1/2, Step 1500/4062, Loss 0.020873960107564926 (0.12436012863873354)
 20%|████████▎                                 | 1601/8124 [12:10<49:37,  2.19it/s]03/19/2025 22:36:22 - INFO - __main__ - Epoch 1/2, Step 1600/4062, Loss 0.03768269717693329 (0.11817816789433602)
 21%|████████▊                                 | 1701/8124 [12:56<48:50,  2.19it/s]03/19/2025 22:37:08 - INFO - __main__ - Epoch 1/2, Step 1700/4062, Loss 0.015849128365516663 (0.11274675606147139)
 22%|█████████▎                                | 1801/8124 [13:42<48:05,  2.19it/s]03/19/2025 22:37:54 - INFO - __main__ - Epoch 1/2, Step 1800/4062, Loss 0.02890237793326378 (0.10785883500564973)
 23%|█████████▊                                | 1901/8124 [14:27<47:18,  2.19it/s]03/19/2025 22:38:39 - INFO - __main__ - Epoch 1/2, Step 1900/4062, Loss 0.025152867659926414 (0.10347527553886371)
 25%|██████████▎                               | 2001/8124 [15:13<46:33,  2.19it/s]03/19/2025 22:39:25 - INFO - __main__ - Epoch 1/2, Step 2000/4062, Loss 0.012821614742279053 (0.09964704299894818)
 26%|██████████▊                               | 2101/8124 [15:58<45:47,  2.19it/s]03/19/2025 22:40:10 - INFO - __main__ - Epoch 1/2, Step 2100/4062, Loss 0.029000122100114822 (0.09611972192211918)
 27%|███████████▍                              | 2201/8124 [16:44<45:01,  2.19it/s]03/19/2025 22:40:56 - INFO - __main__ - Epoch 1/2, Step 2200/4062, Loss 0.02110196463763714 (0.09287440414726227)
 28%|███████████▉                              | 2301/8124 [17:30<44:17,  2.19it/s]03/19/2025 22:41:42 - INFO - __main__ - Epoch 1/2, Step 2300/4062, Loss 0.01756652444601059 (0.08986846183826164)
 30%|████████████▍                             | 2401/8124 [18:15<43:30,  2.19it/s]03/19/2025 22:42:27 - INFO - __main__ - Epoch 1/2, Step 2400/4062, Loss 0.008058100938796997 (0.0871397259729336)
 31%|████████████▉                             | 2501/8124 [19:01<42:45,  2.19it/s]03/19/2025 22:43:13 - INFO - __main__ - Epoch 1/2, Step 2500/4062, Loss 0.02508099377155304 (0.0847004552255245)
 32%|█████████████▍                            | 2601/8124 [19:47<42:00,  2.19it/s]03/19/2025 22:43:59 - INFO - __main__ - Epoch 1/2, Step 2600/4062, Loss 0.02020988240838051 (0.08236748736526463)
 33%|█████████████▉                            | 2701/8124 [20:32<41:13,  2.19it/s]03/19/2025 22:44:44 - INFO - __main__ - Epoch 1/2, Step 2700/4062, Loss 0.033374201506376266 (0.08020553868594975)
 34%|██████████████▍                           | 2801/8124 [21:18<40:27,  2.19it/s]03/19/2025 22:45:30 - INFO - __main__ - Epoch 1/2, Step 2800/4062, Loss 0.016631092876195908 (0.0781268770788204)
 36%|██████████████▉                           | 2901/8124 [22:03<39:43,  2.19it/s]03/19/2025 22:46:15 - INFO - __main__ - Epoch 1/2, Step 2900/4062, Loss 0.02760796807706356 (0.07621381148665127)
 37%|███████████████▌                          | 3001/8124 [22:49<38:57,  2.19it/s]03/19/2025 22:47:01 - INFO - __main__ - Epoch 1/2, Step 3000/4062, Loss 0.03300757706165314 (0.0744586576819693)
 38%|████████████████                          | 3101/8124 [23:35<38:12,  2.19it/s]03/19/2025 22:47:47 - INFO - __main__ - Epoch 1/2, Step 3100/4062, Loss 0.013599798083305359 (0.07281303864455356)
 39%|████████████████▌                         | 3201/8124 [24:20<37:26,  2.19it/s]03/19/2025 22:48:32 - INFO - __main__ - Epoch 1/2, Step 3200/4062, Loss 0.014990471303462982 (0.07129039438191181)
 41%|█████████████████                         | 3301/8124 [25:06<36:40,  2.19it/s]03/19/2025 22:49:18 - INFO - __main__ - Epoch 1/2, Step 3300/4062, Loss 0.03688713163137436 (0.06986809651906524)
 42%|█████████████████▌                        | 3401/8124 [25:52<35:53,  2.19it/s]03/19/2025 22:50:04 - INFO - __main__ - Epoch 1/2, Step 3400/4062, Loss 0.03563085198402405 (0.06857503022080119)
 43%|██████████████████                        | 3501/8124 [26:37<35:08,  2.19it/s]03/19/2025 22:50:49 - INFO - __main__ - Epoch 1/2, Step 3500/4062, Loss 0.022397484630346298 (0.0672763150077078)
 44%|██████████████████▌                       | 3601/8124 [27:23<34:24,  2.19it/s]03/19/2025 22:51:35 - INFO - __main__ - Epoch 1/2, Step 3600/4062, Loss 0.013420086354017258 (0.06605665604549005)
 46%|███████████████████▏                      | 3701/8124 [28:09<33:38,  2.19it/s]03/19/2025 22:52:20 - INFO - __main__ - Epoch 1/2, Step 3700/4062, Loss 0.0312991738319397 (0.06492506289742414)
 47%|███████████████████▋                      | 3801/8124 [28:54<32:52,  2.19it/s]03/19/2025 22:53:06 - INFO - __main__ - Epoch 1/2, Step 3800/4062, Loss 0.03162737190723419 (0.06386074154843326)
 48%|████████████████████▏                     | 3901/8124 [29:40<32:07,  2.19it/s]03/19/2025 22:53:52 - INFO - __main__ - Epoch 1/2, Step 3900/4062, Loss 0.034177590161561966 (0.06278540321461755)
 49%|████████████████████▋                     | 4001/8124 [30:25<31:20,  2.19it/s]03/19/2025 22:54:37 - INFO - __main__ - Epoch 1/2, Step 4000/4062, Loss 0.04191714525222778 (0.061814838746747425)
100%|██████████████████████████████████████████████| 20/20 [00:00<00:00, 36.12it/s]
03/19/2025 22:55:06 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
03/19/2025 22:55:06 - INFO - numexpr.utils - NumExpr defaulting to 8 threads.
Checkpoint saved at experiments/exp-14-ddpm/checkpoints/checkpoint_epoch_0.pth
03/19/2025 22:55:07 - INFO - __main__ - Epoch 2/2
 50%|████████████████████                    | 4063/8124 [30:55<1:01:36,  1.10it/s]03/19/2025 22:55:07 - INFO - __main__ - Epoch 2/2, Step 0/4062, Loss 0.015338427387177944 (0.015338427387177944)
 51%|█████████████████████▌                    | 4163/8124 [31:41<30:07,  2.19it/s]03/19/2025 22:55:53 - INFO - __main__ - Epoch 2/2, Step 100/4062, Loss 0.020328864455223083 (0.02390297001578135)
 52%|██████████████████████                    | 4263/8124 [32:27<29:21,  2.19it/s]03/19/2025 22:56:39 - INFO - __main__ - Epoch 2/2, Step 200/4062, Loss 0.03374495357275009 (0.02308131380710955)
 54%|██████████████████████▌                   | 4363/8124 [33:12<28:36,  2.19it/s]03/19/2025 22:57:24 - INFO - __main__ - Epoch 2/2, Step 300/4062, Loss 0.07454469799995422 (0.023418501850242333)
 55%|███████████████████████                   | 4463/8124 [33:58<27:50,  2.19it/s]03/19/2025 22:58:10 - INFO - __main__ - Epoch 2/2, Step 400/4062, Loss 0.05133333429694176 (0.023079103265338557)
 56%|███████████████████████▌                  | 4563/8124 [34:43<27:04,  2.19it/s]03/19/2025 22:58:55 - INFO - __main__ - Epoch 2/2, Step 500/4062, Loss 0.026502108201384544 (0.023065040246797296)
 57%|████████████████████████                  | 4663/8124 [35:29<26:19,  2.19it/s]03/19/2025 22:59:41 - INFO - __main__ - Epoch 2/2, Step 600/4062, Loss 0.01156485266983509 (0.02299242192560097)
 59%|████████████████████████▌                 | 4763/8124 [36:15<25:33,  2.19it/s]03/19/2025 23:00:27 - INFO - __main__ - Epoch 2/2, Step 700/4062, Loss 0.013984456658363342 (0.022989293732434597)
 60%|█████████████████████████▏                | 4863/8124 [37:00<24:47,  2.19it/s]03/19/2025 23:01:12 - INFO - __main__ - Epoch 2/2, Step 800/4062, Loss 0.03857722505927086 (0.022985658486293498)
 61%|█████████████████████████▋                | 4963/8124 [37:46<24:01,  2.19it/s]03/19/2025 23:01:58 - INFO - __main__ - Epoch 2/2, Step 900/4062, Loss 0.00945134274661541 (0.022973831020477543)
 62%|██████████████████████████▏               | 5063/8124 [38:32<23:16,  2.19it/s]03/19/2025 23:02:44 - INFO - __main__ - Epoch 2/2, Step 1000/4062, Loss 0.020421123132109642 (0.022931402683589275)
 64%|██████████████████████████▋               | 5163/8124 [39:17<22:31,  2.19it/s]03/19/2025 23:03:29 - INFO - __main__ - Epoch 2/2, Step 1100/4062, Loss 0.012940949760377407 (0.02296710304948049)
 65%|███████████████████████████▏              | 5263/8124 [40:03<21:45,  2.19it/s]03/19/2025 23:04:15 - INFO - __main__ - Epoch 2/2, Step 1200/4062, Loss 0.018514782190322876 (0.022832203028315706)
 66%|███████████████████████████▋              | 5363/8124 [40:49<20:59,  2.19it/s]03/19/2025 23:05:01 - INFO - __main__ - Epoch 2/2, Step 1300/4062, Loss 0.016243480145931244 (0.022821191074090405)
 67%|████████████████████████████▏             | 5463/8124 [41:34<20:14,  2.19it/s]03/19/2025 23:05:46 - INFO - __main__ - Epoch 2/2, Step 1400/4062, Loss 0.01785876974463463 (0.022803159112869884)
 68%|████████████████████████████▊             | 5563/8124 [42:20<19:28,  2.19it/s]03/19/2025 23:06:32 - INFO - __main__ - Epoch 2/2, Step 1500/4062, Loss 0.01864255778491497 (0.02287761281634731)
 70%|█████████████████████████████▎            | 5663/8124 [43:05<18:42,  2.19it/s]03/19/2025 23:07:17 - INFO - __main__ - Epoch 2/2, Step 1600/4062, Loss 0.023258015513420105 (0.022765426028596655)
 71%|█████████████████████████████▊            | 5763/8124 [43:51<17:57,  2.19it/s]03/19/2025 23:08:03 - INFO - __main__ - Epoch 2/2, Step 1700/4062, Loss 0.02316037379205227 (0.02288438088979478)
 72%|██████████████████████████████▎           | 5863/8124 [44:37<17:11,  2.19it/s]03/19/2025 23:08:49 - INFO - __main__ - Epoch 2/2, Step 1800/4062, Loss 0.04426310583949089 (0.022736314478082616)
 73%|██████████████████████████████▊           | 5963/8124 [45:22<16:26,  2.19it/s]03/19/2025 23:09:34 - INFO - __main__ - Epoch 2/2, Step 1900/4062, Loss 0.03604285418987274 (0.022791919020934914)
 75%|███████████████████████████████▎          | 6063/8124 [46:08<15:40,  2.19it/s]03/19/2025 23:10:20 - INFO - __main__ - Epoch 2/2, Step 2000/4062, Loss 0.021956022828817368 (0.022821283666766074)
 76%|███████████████████████████████▊          | 6163/8124 [46:54<14:54,  2.19it/s]03/19/2025 23:11:06 - INFO - __main__ - Epoch 2/2, Step 2100/4062, Loss 0.02613714337348938 (0.02289636697516427)
 77%|████████████████████████████████▍         | 6263/8124 [47:39<14:09,  2.19it/s]03/19/2025 23:11:51 - INFO - __main__ - Epoch 2/2, Step 2200/4062, Loss 0.021793633699417114 (0.02292887883993718)
 78%|████████████████████████████████▉         | 6363/8124 [48:25<13:23,  2.19it/s]03/19/2025 23:12:37 - INFO - __main__ - Epoch 2/2, Step 2300/4062, Loss 0.02260780893266201 (0.022826790644292248)
 80%|█████████████████████████████████▍        | 6463/8124 [49:11<12:38,  2.19it/s]03/19/2025 23:13:23 - INFO - __main__ - Epoch 2/2, Step 2400/4062, Loss 0.01567307487130165 (0.022817524749109183)
 81%|█████████████████████████████████▉        | 6563/8124 [49:56<11:52,  2.19it/s]03/19/2025 23:14:08 - INFO - __main__ - Epoch 2/2, Step 2500/4062, Loss 0.007724673952907324 (0.022787032361443593)
 82%|██████████████████████████████████▍       | 6663/8124 [50:42<11:06,  2.19it/s]03/19/2025 23:14:54 - INFO - __main__ - Epoch 2/2, Step 2600/4062, Loss 0.01364787109196186 (0.022764070446129284)
 83%|██████████████████████████████████▉       | 6763/8124 [51:28<10:21,  2.19it/s]03/19/2025 23:15:40 - INFO - __main__ - Epoch 2/2, Step 2700/4062, Loss 0.01902320794761181 (0.02274749751134835)
 84%|███████████████████████████████████▍      | 6863/8124 [52:13<09:35,  2.19it/s]03/19/2025 23:16:25 - INFO - __main__ - Epoch 2/2, Step 2800/4062, Loss 0.036307528614997864 (0.022751234485596548)
 86%|███████████████████████████████████▉      | 6963/8124 [52:59<08:49,  2.19it/s]03/19/2025 23:17:11 - INFO - __main__ - Epoch 2/2, Step 2900/4062, Loss 0.018142476677894592 (0.022723730737314537)
 87%|████████████████████████████████████▌     | 7063/8124 [53:44<08:04,  2.19it/s]03/19/2025 23:17:56 - INFO - __main__ - Epoch 2/2, Step 3000/4062, Loss 0.0277267899364233 (0.022743222170553776)
 88%|█████████████████████████████████████     | 7163/8124 [54:30<07:18,  2.19it/s]03/19/2025 23:18:42 - INFO - __main__ - Epoch 2/2, Step 3100/4062, Loss 0.025536641478538513 (0.022720513523576413)
 89%|█████████████████████████████████████▌    | 7263/8124 [55:16<06:32,  2.19it/s]03/19/2025 23:19:28 - INFO - __main__ - Epoch 2/2, Step 3200/4062, Loss 0.036766935139894485 (0.0227331474630854)
 91%|██████████████████████████████████████    | 7363/8124 [56:01<05:47,  2.19it/s]03/19/2025 23:20:13 - INFO - __main__ - Epoch 2/2, Step 3300/4062, Loss 0.01725357584655285 (0.022649108870809807)
 92%|██████████████████████████████████████▌   | 7463/8124 [56:47<05:01,  2.19it/s]03/19/2025 23:20:59 - INFO - __main__ - Epoch 2/2, Step 3400/4062, Loss 0.01227680966258049 (0.022619663943640365)
 93%|███████████████████████████████████████   | 7563/8124 [57:33<04:15,  2.19it/s]03/19/2025 23:21:45 - INFO - __main__ - Epoch 2/2, Step 3500/4062, Loss 0.026751553639769554 (0.022675043915261952)
 94%|███████████████████████████████████████▌  | 7663/8124 [58:18<03:30,  2.19it/s]03/19/2025 23:22:30 - INFO - __main__ - Epoch 2/2, Step 3600/4062, Loss 0.03631298243999481 (0.022717352256295755)
 96%|████████████████████████████████████████▏ | 7763/8124 [59:04<02:44,  2.19it/s]03/19/2025 23:23:16 - INFO - __main__ - Epoch 2/2, Step 3700/4062, Loss 0.0203576497733593 (0.02271287766431444)
 97%|████████████████████████████████████████▋ | 7863/8124 [59:50<01:59,  2.19it/s]03/19/2025 23:24:02 - INFO - __main__ - Epoch 2/2, Step 3800/4062, Loss 0.01366483699530363 (0.022692284760082775)
 98%|███████████████████████████████████████▏| 7963/8124 [1:00:35<01:13,  2.19it/s]03/19/2025 23:24:47 - INFO - __main__ - Epoch 2/2, Step 3900/4062, Loss 0.023856615647673607 (0.022673451435393864)
 99%|███████████████████████████████████████▋| 8063/8124 [1:01:21<00:27,  2.19it/s]03/19/2025 23:25:33 - INFO - __main__ - Epoch 2/2, Step 4000/4062, Loss 0.056944750249385834 (0.0226867496423792)
100%|██████████████████████████████████████████████| 20/20 [00:00<00:00, 42.15it/s]
100%|████████████████████████████████████████| 8124/8124 [1:01:50<00:00,  2.19it/s]
Checkpoint saved at experiments/exp-14-ddpm/checkpoints/checkpoint_epoch_1.pth
