03/19/2025 21:59:38 - INFO - __main__ - ***** Training arguments *****
03/19/2025 21:59:38 - INFO - __main__ - Namespace(config='configs/ddim.yaml', data_dir='../imagenet100_128x128/train', image_size=128, batch_size=32, num_workers=5, num_classes=100, run_name='exp-12-ddpm', output_dir='experiments', num_epochs=2, learning_rate=0.0001, weight_decay=1e-05, grad_clip=1.0, seed=42, mixed_precision='fp16', num_train_timesteps=1000, num_inference_steps=20, beta_start=0.0001, beta_end=0.02, beta_schedule='linear', variance_type='fixed_small', prediction_type='epsilon', clip_sample=True, clip_sample_range=1.0, unet_in_size=128, unet_in_ch=3, unet_ch=32, unet_ch_mult=[1, 1, 2, 2], unet_attn=[2], unet_num_res_blocks=2, unet_dropout=0.0, latent_ddpm=False, use_cfg=False, cfg_guidance_scale=2.0, use_ddim=True, ckpt=None, distributed=False, world_size=1, rank=0, local_rank=0, device='cuda', total_batch_size=32, max_train_steps=8124)
03/19/2025 21:59:38 - INFO - __main__ - ***** Running training *****
03/19/2025 21:59:38 - INFO - __main__ -   Num examples = 130000
03/19/2025 21:59:38 - INFO - __main__ -   Num Epochs = 2
03/19/2025 21:59:38 - INFO - __main__ -   Instantaneous batch size per device = 32
03/19/2025 21:59:38 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
03/19/2025 21:59:38 - INFO - __main__ -   Total optimization steps per epoch 4062
03/19/2025 21:59:38 - INFO - __main__ -   Total optimization steps = 8124
  0%|                                                     | 0/8124 [00:00<?, ?it/s]03/19/2025 21:59:38 - INFO - __main__ - Epoch 1/2
  0%|                                           | 1/8124 [00:00<1:35:17,  1.42it/s]03/19/2025 21:59:39 - INFO - __main__ - Epoch 1/2, Step 0/4062, Loss 0.997072696685791 (0.997072696685791)
  1%|▌                                          | 101/8124 [00:15<19:37,  6.82it/s]03/19/2025 21:59:53 - INFO - __main__ - Epoch 1/2, Step 100/4062, Loss 0.8020428419113159 (0.9146882679202769)
  2%|█                                          | 201/8124 [00:29<19:19,  6.83it/s]03/19/2025 22:00:08 - INFO - __main__ - Epoch 1/2, Step 200/4062, Loss 0.5892961621284485 (0.8056297999116319)
  4%|█▌                                         | 301/8124 [00:44<19:05,  6.83it/s]03/19/2025 22:00:22 - INFO - __main__ - Epoch 1/2, Step 300/4062, Loss 0.43036460876464844 (0.7049555275527346)
  5%|██                                         | 401/8124 [00:59<18:50,  6.83it/s]03/19/2025 22:00:37 - INFO - __main__ - Epoch 1/2, Step 400/4062, Loss 0.28183984756469727 (0.6160173827870529)
  6%|██▋                                        | 501/8124 [01:13<18:36,  6.83it/s]03/19/2025 22:00:52 - INFO - __main__ - Epoch 1/2, Step 500/4062, Loss 0.17369329929351807 (0.5387978565074251)
  7%|███▏                                       | 601/8124 [01:28<18:20,  6.84it/s]03/19/2025 22:01:06 - INFO - __main__ - Epoch 1/2, Step 600/4062, Loss 0.10789921134710312 (0.47319777158651494)
  9%|███▋                                       | 701/8124 [01:43<18:07,  6.82it/s]03/19/2025 22:01:21 - INFO - __main__ - Epoch 1/2, Step 700/4062, Loss 0.10885509848594666 (0.4195195806721563)
 10%|████▏                                      | 801/8124 [01:57<17:51,  6.84it/s]03/19/2025 22:01:36 - INFO - __main__ - Epoch 1/2, Step 800/4062, Loss 0.047546159476041794 (0.37530881210640726)
 11%|████▊                                      | 901/8124 [02:12<17:36,  6.84it/s]03/19/2025 22:01:50 - INFO - __main__ - Epoch 1/2, Step 900/4062, Loss 0.03683057054877281 (0.3393631607343698)
 12%|█████▏                                    | 1001/8124 [02:27<17:23,  6.83it/s]03/19/2025 22:02:05 - INFO - __main__ - Epoch 1/2, Step 1000/4062, Loss 0.03587903454899788 (0.30971496246502056)
 14%|█████▋                                    | 1101/8124 [02:41<17:08,  6.83it/s]03/19/2025 22:02:20 - INFO - __main__ - Epoch 1/2, Step 1100/4062, Loss 0.02975364588201046 (0.2848450115050353)
 15%|██████▏                                   | 1201/8124 [02:56<16:53,  6.83it/s]03/19/2025 22:02:34 - INFO - __main__ - Epoch 1/2, Step 1200/4062, Loss 0.02032611519098282 (0.2639447202484165)
 16%|██████▋                                   | 1301/8124 [03:11<16:40,  6.82it/s]03/19/2025 22:02:49 - INFO - __main__ - Epoch 1/2, Step 1300/4062, Loss 0.041116394102573395 (0.24601223657793903)
 17%|███████▏                                  | 1401/8124 [03:25<16:24,  6.83it/s]03/19/2025 22:03:04 - INFO - __main__ - Epoch 1/2, Step 1400/4062, Loss 0.03732156381011009 (0.2306770440184383)
 18%|███████▊                                  | 1501/8124 [03:40<16:09,  6.83it/s]03/19/2025 22:03:18 - INFO - __main__ - Epoch 1/2, Step 1500/4062, Loss 0.022511735558509827 (0.2173980240226735)
 20%|████████▎                                 | 1601/8124 [03:55<15:55,  6.83it/s]03/19/2025 22:03:33 - INFO - __main__ - Epoch 1/2, Step 1600/4062, Loss 0.04848506674170494 (0.20568583547827007)
 21%|████████▊                                 | 1701/8124 [04:09<15:40,  6.83it/s]03/19/2025 22:03:48 - INFO - __main__ - Epoch 1/2, Step 1700/4062, Loss 0.014731748029589653 (0.19530199095004538)
 22%|█████████▎                                | 1801/8124 [04:24<15:25,  6.83it/s]03/19/2025 22:04:02 - INFO - __main__ - Epoch 1/2, Step 1800/4062, Loss 0.03308170288801193 (0.18600803190094523)
 23%|█████████▊                                | 1901/8124 [04:38<15:10,  6.83it/s]03/19/2025 22:04:17 - INFO - __main__ - Epoch 1/2, Step 1900/4062, Loss 0.04072978347539902 (0.1776495113080149)
 25%|██████████▎                               | 2001/8124 [04:53<14:55,  6.84it/s]03/19/2025 22:04:31 - INFO - __main__ - Epoch 1/2, Step 2000/4062, Loss 0.020452100783586502 (0.17027104716479913)
 26%|██████████▊                               | 2101/8124 [05:08<14:42,  6.82it/s]03/19/2025 22:04:46 - INFO - __main__ - Epoch 1/2, Step 2100/4062, Loss 0.036857970058918 (0.16352494029564937)
 27%|███████████▍                              | 2201/8124 [05:22<14:26,  6.84it/s]03/19/2025 22:05:01 - INFO - __main__ - Epoch 1/2, Step 2200/4062, Loss 0.037417661398649216 (0.15734020455434464)
 28%|███████████▉                              | 2301/8124 [05:37<14:12,  6.83it/s]03/19/2025 22:05:15 - INFO - __main__ - Epoch 1/2, Step 2300/4062, Loss 0.015083683654665947 (0.15167431040354937)
 30%|████████████▍                             | 2401/8124 [05:52<13:57,  6.83it/s]03/19/2025 22:05:30 - INFO - __main__ - Epoch 1/2, Step 2400/4062, Loss 0.010415132157504559 (0.14647490576123728)
 31%|████████████▉                             | 2501/8124 [06:06<13:42,  6.84it/s]03/19/2025 22:05:45 - INFO - __main__ - Epoch 1/2, Step 2500/4062, Loss 0.022722147405147552 (0.1417806404733994)
 32%|█████████████▍                            | 2601/8124 [06:21<13:28,  6.83it/s]03/19/2025 22:05:59 - INFO - __main__ - Epoch 1/2, Step 2600/4062, Loss 0.026434611529111862 (0.13736071821834975)
 33%|█████████████▉                            | 2701/8124 [06:36<13:14,  6.83it/s]03/19/2025 22:06:14 - INFO - __main__ - Epoch 1/2, Step 2700/4062, Loss 0.04446268081665039 (0.13326700794159185)
 34%|██████████████▍                           | 2801/8124 [06:50<12:58,  6.84it/s]03/19/2025 22:06:29 - INFO - __main__ - Epoch 1/2, Step 2800/4062, Loss 0.021273788064718246 (0.12943130711333609)
 36%|██████████████▉                           | 2901/8124 [07:05<12:44,  6.83it/s]03/19/2025 22:06:43 - INFO - __main__ - Epoch 1/2, Step 2900/4062, Loss 0.0329214446246624 (0.12581344347245546)
 37%|███████████████▌                          | 3001/8124 [07:19<12:29,  6.83it/s]03/19/2025 22:06:58 - INFO - __main__ - Epoch 1/2, Step 3000/4062, Loss 0.037390198558568954 (0.12250147698405522)
 38%|████████████████                          | 3101/8124 [07:34<12:14,  6.83it/s]03/19/2025 22:07:13 - INFO - __main__ - Epoch 1/2, Step 3100/4062, Loss 0.019312521442770958 (0.11939346410576776)
 39%|████████████████▌                         | 3201/8124 [07:49<12:00,  6.83it/s]03/19/2025 22:07:27 - INFO - __main__ - Epoch 1/2, Step 3200/4062, Loss 0.01661418192088604 (0.11653054454001653)
 41%|█████████████████                         | 3301/8124 [08:03<11:45,  6.84it/s]03/19/2025 22:07:42 - INFO - __main__ - Epoch 1/2, Step 3300/4062, Loss 0.02933216094970703 (0.11380285777713595)
 42%|█████████████████▌                        | 3401/8124 [08:18<11:31,  6.83it/s]03/19/2025 22:07:56 - INFO - __main__ - Epoch 1/2, Step 3400/4062, Loss 0.04742639511823654 (0.11132344223040802)
 43%|██████████████████                        | 3501/8124 [08:33<11:16,  6.83it/s]03/19/2025 22:08:11 - INFO - __main__ - Epoch 1/2, Step 3500/4062, Loss 0.023001790046691895 (0.10887827596464109)
 44%|██████████████████▌                       | 3601/8124 [08:47<11:01,  6.83it/s]03/19/2025 22:08:26 - INFO - __main__ - Epoch 1/2, Step 3600/4062, Loss 0.0161266028881073 (0.1065559825687717)
 46%|███████████████████▏                      | 3701/8124 [09:02<10:46,  6.84it/s]03/19/2025 22:08:40 - INFO - __main__ - Epoch 1/2, Step 3700/4062, Loss 0.044365040957927704 (0.10441338537075683)
 47%|███████████████████▋                      | 3801/8124 [09:17<10:35,  6.81it/s]03/19/2025 22:08:55 - INFO - __main__ - Epoch 1/2, Step 3800/4062, Loss 0.0357477143406868 (0.10236094410841663)
 48%|████████████████████▏                     | 3901/8124 [09:31<10:17,  6.84it/s]03/19/2025 22:09:10 - INFO - __main__ - Epoch 1/2, Step 3900/4062, Loss 0.0370778851211071 (0.10038783015650825)
 49%|████████████████████▋                     | 4001/8124 [09:46<10:03,  6.83it/s]03/19/2025 22:09:24 - INFO - __main__ - Epoch 1/2, Step 4000/4062, Loss 0.04100550711154938 (0.0985281008500089)
100%|██████████████████████████████████████████████| 20/20 [00:00<00:00, 60.59it/s]
03/19/2025 22:09:34 - INFO - numexpr.utils - Note: NumExpr detected 40 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
03/19/2025 22:09:34 - INFO - numexpr.utils - NumExpr defaulting to 8 threads.
Checkpoint saved at experiments/exp-12-ddpm/checkpoints/checkpoint_epoch_0.pth
03/19/2025 22:09:35 - INFO - __main__ - Epoch 2/2
 50%|█████████████████████                     | 4063/8124 [09:56<39:00,  1.74it/s]03/19/2025 22:09:35 - INFO - __main__ - Epoch 2/2, Step 0/4062, Loss 0.017091352492570877 (0.017091352492570877)
 51%|█████████████████████▌                    | 4163/8124 [10:11<09:39,  6.84it/s]03/19/2025 22:09:49 - INFO - __main__ - Epoch 2/2, Step 100/4062, Loss 0.023040052503347397 (0.026407747916729733)
 52%|██████████████████████                    | 4263/8124 [10:26<09:24,  6.84it/s]03/19/2025 22:10:04 - INFO - __main__ - Epoch 2/2, Step 200/4062, Loss 0.04057375714182854 (0.02570945793178989)
 54%|██████████████████████▌                   | 4363/8124 [10:40<09:09,  6.84it/s]03/19/2025 22:10:19 - INFO - __main__ - Epoch 2/2, Step 300/4062, Loss 0.0740383043885231 (0.02601829817073042)
 55%|███████████████████████                   | 4463/8124 [10:55<08:55,  6.84it/s]03/19/2025 22:10:33 - INFO - __main__ - Epoch 2/2, Step 400/4062, Loss 0.05331626161932945 (0.025814319260539186)
 56%|███████████████████████▌                  | 4563/8124 [11:10<08:40,  6.84it/s]03/19/2025 22:10:48 - INFO - __main__ - Epoch 2/2, Step 500/4062, Loss 0.03468140959739685 (0.025753869858204187)
 57%|████████████████████████                  | 4663/8124 [11:24<08:25,  6.84it/s]03/19/2025 22:11:03 - INFO - __main__ - Epoch 2/2, Step 600/4062, Loss 0.008873997256159782 (0.025589945162809182)
 59%|████████████████████████▌                 | 4763/8124 [11:39<08:11,  6.84it/s]03/19/2025 22:11:17 - INFO - __main__ - Epoch 2/2, Step 700/4062, Loss 0.014426155015826225 (0.025425882531747157)
 60%|█████████████████████████▏                | 4863/8124 [11:53<07:56,  6.84it/s]03/19/2025 22:11:32 - INFO - __main__ - Epoch 2/2, Step 800/4062, Loss 0.03438863903284073 (0.025406462367107807)
 61%|█████████████████████████▋                | 4963/8124 [12:08<07:43,  6.83it/s]03/19/2025 22:11:46 - INFO - __main__ - Epoch 2/2, Step 900/4062, Loss 0.012066110968589783 (0.025430170964908586)
 62%|██████████████████████████▏               | 5063/8124 [12:23<07:27,  6.84it/s]03/19/2025 22:12:01 - INFO - __main__ - Epoch 2/2, Step 1000/4062, Loss 0.025751367211341858 (0.025410826249582158)
 64%|██████████████████████████▋               | 5163/8124 [12:37<07:12,  6.84it/s]03/19/2025 22:12:16 - INFO - __main__ - Epoch 2/2, Step 1100/4062, Loss 0.015483046881854534 (0.025410299814922852)
 65%|███████████████████████████▏              | 5263/8124 [12:52<06:58,  6.84it/s]03/19/2025 22:12:30 - INFO - __main__ - Epoch 2/2, Step 1200/4062, Loss 0.021290605887770653 (0.0253305059972434)
 66%|███████████████████████████▋              | 5363/8124 [13:07<06:43,  6.85it/s]03/19/2025 22:12:45 - INFO - __main__ - Epoch 2/2, Step 1300/4062, Loss 0.02253217063844204 (0.025333433722336988)
 67%|████████████████████████████▏             | 5463/8124 [13:21<06:29,  6.84it/s]03/19/2025 22:13:00 - INFO - __main__ - Epoch 2/2, Step 1400/4062, Loss 0.021172743290662766 (0.025284322085381512)
 68%|████████████████████████████▊             | 5563/8124 [13:36<06:14,  6.84it/s]03/19/2025 22:13:14 - INFO - __main__ - Epoch 2/2, Step 1500/4062, Loss 0.017831843346357346 (0.02544693479210208)
 70%|█████████████████████████████▎            | 5663/8124 [13:50<05:59,  6.84it/s]03/19/2025 22:13:29 - INFO - __main__ - Epoch 2/2, Step 1600/4062, Loss 0.043671052902936935 (0.025340398881458757)
 71%|█████████████████████████████▊            | 5763/8124 [14:05<05:46,  6.82it/s]03/19/2025 22:13:43 - INFO - __main__ - Epoch 2/2, Step 1700/4062, Loss 0.037466153502464294 (0.025453621512558148)
 72%|██████████████████████████████▎           | 5863/8124 [14:20<05:31,  6.82it/s]03/19/2025 22:13:58 - INFO - __main__ - Epoch 2/2, Step 1800/4062, Loss 0.034947000443935394 (0.025292251658042077)
 73%|██████████████████████████████▊           | 5963/8124 [14:34<05:16,  6.84it/s]03/19/2025 22:14:13 - INFO - __main__ - Epoch 2/2, Step 1900/4062, Loss 0.035090986639261246 (0.025320063269932778)
 75%|███████████████████████████████▎          | 6063/8124 [14:49<05:01,  6.84it/s]03/19/2025 22:14:27 - INFO - __main__ - Epoch 2/2, Step 2000/4062, Loss 0.023483414202928543 (0.025327486502912375)
 76%|███████████████████████████████▊          | 6163/8124 [15:04<04:46,  6.84it/s]03/19/2025 22:14:42 - INFO - __main__ - Epoch 2/2, Step 2100/4062, Loss 0.03768231347203255 (0.025401469516208388)
 77%|████████████████████████████████▍         | 6263/8124 [15:18<04:32,  6.84it/s]03/19/2025 22:14:57 - INFO - __main__ - Epoch 2/2, Step 2200/4062, Loss 0.02715456485748291 (0.025384482571551376)
 78%|████████████████████████████████▉         | 6363/8124 [15:33<04:17,  6.84it/s]03/19/2025 22:15:11 - INFO - __main__ - Epoch 2/2, Step 2300/4062, Loss 0.028934447094798088 (0.02530869317246275)
 80%|█████████████████████████████████▍        | 6463/8124 [15:47<04:02,  6.85it/s]03/19/2025 22:15:26 - INFO - __main__ - Epoch 2/2, Step 2400/4062, Loss 0.015213504433631897 (0.025291270651861944)
 81%|█████████████████████████████████▉        | 6563/8124 [16:02<03:48,  6.83it/s]03/19/2025 22:15:40 - INFO - __main__ - Epoch 2/2, Step 2500/4062, Loss 0.013261789456009865 (0.02528139401204148)
 82%|██████████████████████████████████▍       | 6663/8124 [16:17<03:33,  6.84it/s]03/19/2025 22:15:55 - INFO - __main__ - Epoch 2/2, Step 2600/4062, Loss 0.010848271660506725 (0.025281139399701644)
 83%|██████████████████████████████████▉       | 6763/8124 [16:31<03:19,  6.84it/s]03/19/2025 22:16:10 - INFO - __main__ - Epoch 2/2, Step 2700/4062, Loss 0.023341959342360497 (0.0252857648478583)
 84%|███████████████████████████████████▍      | 6863/8124 [16:46<03:04,  6.84it/s]03/19/2025 22:16:24 - INFO - __main__ - Epoch 2/2, Step 2800/4062, Loss 0.04282129928469658 (0.02532450605904692)
 86%|███████████████████████████████████▉      | 6963/8124 [17:00<02:49,  6.84it/s]03/19/2025 22:16:39 - INFO - __main__ - Epoch 2/2, Step 2900/4062, Loss 0.026430070400238037 (0.025306691234544182)
 87%|████████████████████████████████████▌     | 7063/8124 [17:15<02:35,  6.84it/s]03/19/2025 22:16:53 - INFO - __main__ - Epoch 2/2, Step 3000/4062, Loss 0.03225347399711609 (0.025329180529185313)
 88%|█████████████████████████████████████     | 7163/8124 [17:30<02:20,  6.83it/s]03/19/2025 22:17:08 - INFO - __main__ - Epoch 2/2, Step 3100/4062, Loss 0.029203733429312706 (0.025311935903857077)
 89%|█████████████████████████████████████▌    | 7263/8124 [17:44<02:05,  6.85it/s]03/19/2025 22:17:23 - INFO - __main__ - Epoch 2/2, Step 3200/4062, Loss 0.0449184775352478 (0.025361309375850176)
 91%|██████████████████████████████████████    | 7363/8124 [17:59<01:51,  6.84it/s]03/19/2025 22:17:37 - INFO - __main__ - Epoch 2/2, Step 3300/4062, Loss 0.015466317534446716 (0.02528483487800513)
 92%|██████████████████████████████████████▌   | 7463/8124 [18:14<01:36,  6.84it/s]03/19/2025 22:17:52 - INFO - __main__ - Epoch 2/2, Step 3400/4062, Loss 0.022409606724977493 (0.02523357356082176)
 93%|███████████████████████████████████████   | 7563/8124 [18:28<01:21,  6.84it/s]03/19/2025 22:18:07 - INFO - __main__ - Epoch 2/2, Step 3500/4062, Loss 0.032437488436698914 (0.02528608226707065)
 94%|███████████████████████████████████████▌  | 7663/8124 [18:43<01:07,  6.83it/s]03/19/2025 22:18:21 - INFO - __main__ - Epoch 2/2, Step 3600/4062, Loss 0.02973005175590515 (0.025313745267400597)
 96%|████████████████████████████████████████▏ | 7763/8124 [18:57<00:52,  6.84it/s]03/19/2025 22:18:36 - INFO - __main__ - Epoch 2/2, Step 3700/4062, Loss 0.024154294282197952 (0.025284951806276778)
 97%|████████████████████████████████████████▋ | 7863/8124 [19:12<00:38,  6.84it/s]03/19/2025 22:18:50 - INFO - __main__ - Epoch 2/2, Step 3800/4062, Loss 0.02620442770421505 (0.025274796531210054)
 98%|█████████████████████████████████████████▏| 7963/8124 [19:27<00:23,  6.84it/s]03/19/2025 22:19:05 - INFO - __main__ - Epoch 2/2, Step 3900/4062, Loss 0.03339004889130592 (0.025265535465409415)
 99%|█████████████████████████████████████████▋| 8063/8124 [19:41<00:08,  6.85it/s]03/19/2025 22:19:20 - INFO - __main__ - Epoch 2/2, Step 4000/4062, Loss 0.046959083527326584 (0.025290110603326844)
100%|██████████████████████████████████████████████| 20/20 [00:00<00:00, 81.77it/s]
100%|██████████████████████████████████████████| 8124/8124 [19:51<00:00,  6.82it/s]
Checkpoint saved at experiments/exp-12-ddpm/checkpoints/checkpoint_epoch_1.pth
